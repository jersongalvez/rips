
//////////////////////////////////////////////////////////////////////////////////
/////////////////////////         SISTEMA RIPS         /////////////////////////
/////////////////////////      PIJAOS SALUD EPSI      //////////////////////////
///////////////////          JS CARGAR_PREFACTURA            ///////////////////
/////////////////////////  DEPARTAMENTO DE DESARROLLO  /////////////////////////
///////////////////////  AMBITO: PROCESAMIENTO CAPITA  /////////////////////////
////////          METODOS JS PARA EL PROCESAMIENTO DE INFORMACION        ///////
////////////////////////////////////////////////////////////////////////////////


var solo_numeros=/^\d*$/;function init(){reenvio();const a=document.querySelector("#input-rips input[type=file]");a.onchange=(()=>{if(a.files.length>0){document.querySelector("#input-rips .file-name").textContent=a.files[0].name}}),$(".delete").click(function(){$(".modal").removeClass("is-active")}),$("#closeModal").click(function(){$(".modal").removeClass("is-active")})}function reenvio(){window.history.replaceState&&window.history.replaceState(null,null,window.location.href)}function modal_carga(){$(".loadingpage").fadeOut("slow")}function validarSubida(){return""===$("#archivo").val()?($("#archivo").focus(),alerta("Archivo no válido","Debe cargar un archivo de texto simple"),!1):validarFormatoFecha($("#archivo").prop("files")[0].name.slice(0,-4))?($("#archivo").focus(),alerta("Archivo no válido","El nombre del archivo es inválido, debe tener el formato mm-aaaa"),!1):(modal_procesamiento(),void $("#proceso").addClass("is-loading"))}function validarFormatoFecha(a){return!a.match(/^\d{2}\-\d{4}$/)||""===a}function modal_procesamiento(){$("#modal_factura").addClass("is-active"),$("#modal_prefactura_msg").html("Esta tarea puede tardar dependiendo de la cantidad de registros a validar.")}function alerta(a,e){alertify.alert().setting({title:a,label:"Aceptar",message:'<i class="fas fa-exclamation-triangle"></i> '+e+"."}).show()}function envio_prefactura(a){alertify.confirm('<i class="zmdi zmdi-notifications-active"></i> Los datos asociados no podrán ser modificados después de grabar.').set({title:"¿Esta seguro de grabar el archivo: "+a+"?"}).set({labels:{ok:"Aceptar",cancel:"Cancelar"}}).set("onok",function(){$('<form action="grabar_prefactura.php" method="post">\n                    <input type="hidden" name="datos_grabar" value="1"></input>\n                </form>').appendTo("body").submit().remove(),$("#grabar").attr("disabled",!0),$("#modal_factura").addClass("is-active"),$("#modal_prefactura_msg").html("Preparando la información para iniciar con la inserción de datos, espere un momento.")}).set("onclose",function(){$("#grabar").focus()}).set("defaultFocus","cancel")}function envio_novedades(a,e){var o;e=e||"";switch(a){case 1:o="La extensión o tamaño del archivo no son correctos.";break;case 2:o="El periodo que desea registrar en el sistema, se cargó el: "+e+".";break;case 3:o="El archivo no tiene las especificaciones requeridas."}$("#modal_novedad").html("<div class='modal is-active'> \n <div class='modal-background'></div> \n <div class='modal-card'> \n <header class='modal-card-head'> \n <p class='modal-card-title'> \n <strong>No se puede procesar el archivo</strong> \n  </p>  \n  <button class='delete' aria-label='close' onclick='cerrar_modal()'></button> \n </header> \n <section class='modal-card-body'> \n <p class='has-text-justified'>"+o+"</p> \n </section> \n <footer class='modal-card-foot has-text-centered'> \n <button class='button is-info' onclick='cerrar_modal()'> \n <span class='icon is-small'> <i class='fas fa-exclamation-triangle'></i></span> \n <span> Aceptar </span> \n </button> \n </footer> \n </div> \n </div>")}function cerrar_modal(){$(".modal").removeClass("is-active")}function log_txt(a){$('<form action="../../reportes/log_erroresCap.php" method="post" target="_blank">\n                <input type="hidden" name="values_array" value="'+a+'"></input>\n            </form>').appendTo("body").submit().remove()}function recarga(a){switch(a){case 0:$("#carga").hide(),$("#total_error").hide(),$("#pantalla_prefactura").show(),$("#archivo").focus();break;case 2:$("#carga").hide(),$("#total_error").hide(),$("#grabar_datos").hide(),$("#pantalla_prefactura").show(),$("#archivo").focus()}}init();